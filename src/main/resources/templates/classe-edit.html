<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/layout :: headerParams('Modifier une Classe - UASZ')}"></head>

<body>

<nav th:replace="~{fragments/layout :: navbar}"></nav>
<nav th:replace="~{fragments/layout :: sidebar(activePage='classes')}"></nav>

<main class="main-content">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <div>
            <h2 class="fw-bold text-dark">Modifier la Classe</h2>
            <p class="text-muted mb-0">Mettre à jour les informations de la classe</p>
        </div>
        <a href="/lst-classes" th:href="@{/lst-classes}" class="btn btn-outline-secondary shadow-sm">
            <i class="bi bi-arrow-left me-2"></i>Retour à la liste
        </a>
    </div>

    <!-- Form Card -->
    <div class="row">
        <div class="col-12">
            <div class="card border-0 shadow-sm">
                <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">
                        <i class="bi bi-building me-2"></i>Informations de la classe
                    </h5>
                </div>
                <div class="card-body">
                    <!-- Alerte en cas d'erreur -->
                    <div class="alert alert-danger alert-dismissible fade show shadow-sm" role="alert" th:if="${error != null}">
                        <i class="bi bi-exclamation-triangle-fill me-2"></i>
                        <strong>Erreur!</strong> <span th:text="${error}"></span>
                        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>

                    <form method="post" th:action="@{/update-classe}">
                        <input type="hidden" name="id" th:value="${classe.id}" />

                        <!-- Informations de base -->
                        <div class="section-header">
                            <i class="bi bi-card-checklist me-2"></i>Informations de base
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="code" class="form-label">
                                    Code <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control" id="code"
                                       name="code"
                                       th:value="${classe.code}"
                                       placeholder="Ex: L1-INFO-A" required>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="libelle" class="form-label">
                                    Libellé <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control" id="libelle"
                                       name="libelle"
                                       th:value="${classe.libelle}"
                                       placeholder="Ex: Licence 1 Informatique Groupe A" required>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <label for="description" class="form-label">Description</label>
                                <textarea class="form-control" id="description" rows="3"
                                          name="description"
                                          th:text="${classe.description}"
                                          placeholder="Description de la classe"></textarea>
                            </div>
                        </div>

                        <!-- Rattachement -->
                        <div class="section-header">
                            <i class="bi bi-diagram-3 me-2"></i>Rattachement
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="filiereId" class="form-label">Filière</label>
                                <select class="form-select" id="filiereId" name="filiereId">
                                    <option value="">Sélectionner une filière</option>
                                    <option th:each="filiere : ${filieres}"
                                            th:value="${filiere.id}"
                                            th:text="${filiere.libelle}"
                                            th:selected="${classe.filiere != null && classe.filiere.id == filiere.id}">
                                    </option>
                                </select>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="niveauId" class="form-label">Niveau</label>
                                <select class="form-select" id="niveauId" name="niveauId">
                                    <option value="">Sélectionner un niveau</option>
                                    <option th:each="niveau : ${niveaux}"
                                            th:value="${niveau.id}"
                                            th:text="${niveau.numero + ' - ' + niveau.cycle}"
                                            th:selected="${classe.niveau != null && classe.niveau.id == niveau.id}">
                                    </option>
                                </select>
                            </div>
                        </div>

                        <!-- Détails complémentaires -->
                        <div class="section-header">
                            <i class="bi bi-info-circle me-2"></i>Détails complémentaires
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="anneeAcademique" class="form-label">Année Académique</label>
                                <input type="text" class="form-control" id="anneeAcademique"
                                       name="anneeAcademique"
                                       th:value="${classe.anneeAcademique}"
                                       placeholder="Ex: 2024-2025">
                            </div>
                            <div class="col-md-6 mb-3">
                                <label for="effectifMax" class="form-label">Effectif Maximum</label>
                                <input type="number" class="form-control" id="effectifMax"
                                       name="effectifMax"
                                       th:value="${classe.effectifMax}"
                                       placeholder="Ex: 50" min="1">
                            </div>
                        </div>

                        <!-- Statut (lecture seule) -->
                        <div class="section-header">
                            <i class="bi bi-info-circle me-2"></i>Statut
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label class="form-label">État</label>
                                <div class="form-control-plaintext">
                                    <span class="badge" th:classappend="${classe.estActive} ? 'bg-success' : 'bg-danger'">
                                        <span th:text="${classe.estActive} ? 'Active' : 'Inactive'"></span>
                                    </span>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <label class="form-label">Archivage</label>
                                <div class="form-control-plaintext">
                                    <span class="badge" th:classappend="${classe.estArchivee} ? 'bg-warning' : 'bg-info'">
                                        <span th:text="${classe.estArchivee} ? 'Archivée' : 'Non archivée'"></span>
                                    </span>
                                </div>
                            </div>
                        </div>

                        <!-- Buttons -->
                        <div class="d-flex justify-content-end gap-2 mt-4">
                            <a href="/lst-classes" th:href="@{/lst-classes}" class="btn btn-secondary">
                                <i class="bi bi-x-circle me-2"></i>Annuler
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="bi bi-check-circle me-2"></i>Mettre à jour
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</main>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
